# 🌳 分支统计功能说明

## 功能概述

代码统计工具现在支持**按分支统计**代码量，你可以：

- ✅ 统计**所有分支**的代码（默认）
- ✅ 统计**特定分支**的代码（如 master、main、develop 等）
- ✅ 查看每个仓库有**多少个分支**
- ✅ 在结果中显示**当前统计的分支**信息

## 🎯 使用方法

### 方式一：使用下拉选择器

在"统计分支"下拉框中选择：
- 🌳 **所有分支**（默认）- 统计所有分支的代码
- **master** - 只统计 master 分支
- **main** - 只统计 main 分支
- **develop** - 只统计 develop 分支
- **dev** - 只统计 dev 分支

### 方式二：输入自定义分支名

如果你的分支名称不在列表中：
1. 在"或输入自定义分支名..."输入框中输入分支名
2. 按下 **Enter** 键
3. 分支名称会自动设置到选择器中

例如：
- `feature/new-ui`
- `release/v2.0`
- `hotfix/bug-123`

## 📊 统计结果展示

### 仓库标题中的分支信息

每个仓库的标题会显示：
```
🗂️ my-project
📌 所有分支        ← 当前统计的分支
/Users/xxx/my-project
🌿 共 15 个分支    ← 该仓库的分支总数
```

### 不同分支的对比

你可以多次运行分析，对比不同分支的数据：

**示例 1：统计所有分支**
```
📌 所有分支
- 张三: 10,000 行
- 李四: 8,000 行
```

**示例 2：只统计 master 分支**
```
📌 master
- 张三: 7,000 行
- 李四: 5,000 行
```

## 🔧 技术实现

### Git 命令变化

#### 统计所有分支（默认）
```bash
git log --all --author="username" --pretty=tformat: --numstat
```

#### 统计特定分支
```bash
git log <branch-name> --author="username" --pretty=tformat: --numstat
```

### 后端 API 参数

```javascript
POST /api/analyze
{
  "folderPath": "/path/to/projects",
  "branch": "--all"  // 或具体分支名，如 "master"
}
```

### 返回数据结构

```javascript
{
  "success": true,
  "data": {
    "repositories": [
      {
        "name": "my-project",
        "path": "/Users/xxx/my-project",
        "branch": "所有分支",      // 当前统计的分支
        "branches": ["master", "main", "develop"],  // 所有分支列表
        "contributors": [...]
      }
    ]
  }
}
```

## 💡 使用场景

### 1. 项目整体评估
选择"所有分支"，了解项目的总体代码量和贡献度。

### 2. 生产环境统计
选择 "master" 或 "main"，只统计已发布到生产环境的代码。

### 3. 开发分支对比
选择 "develop"，查看开发中的代码量，与生产环境对比。

### 4. 功能分支统计
输入 "feature/xxx"，统计某个功能分支的开发量。

### 5. 版本发布统计
输入 "release/v2.0"，统计某个版本的代码量。

## ⚙️ 配置说明

### 默认分支

系统默认选择"所有分支"，这是最常用的统计方式。

### 常用分支预设

下拉框中预设了常用的分支名：
- master
- main
- develop
- dev

你可以根据团队习惯修改预设列表。

### 自定义分支

支持任意分支名称，包括：
- 远程分支：`origin/master`
- 功能分支：`feature/xxx`
- 修复分支：`hotfix/xxx`
- 发布分支：`release/xxx`

## 📝 注意事项

### 1. 分支名称大小写
Git 分支名称区分大小写，请确保输入正确：
- ✅ `master`
- ❌ `Master`

### 2. 远程分支
可以统计远程分支，格式为：
- `origin/master`
- `origin/develop`

### 3. 不存在的分支
如果输入的分支不存在，该仓库将返回空的统计结果。

### 4. 分支历史
统计包含该分支的全部历史提交，即使某些提交已合并到其他分支。

## 🎨 界面预览

```
┌─────────────────────────────────────────┐
│ 统计分支：                              │
│ ┌─────────────────────────────────────┐ │
│ │ 🌳 所有分支                    ▼   │ │
│ └─────────────────────────────────────┘ │
│ 💡 也可以手动输入其他分支名             │
│ ┌─────────────────────────────────────┐ │
│ │ 或输入自定义分支名...               │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

结果展示：
```
┌─────────────────────────────────────────┐
│ 🗂️ my-project                          │
│ 📌 所有分支                             │
│ /Users/xxx/my-project                   │
│ 🌿 共 15 个分支                        │
├─────────────────────────────────────────┤
│ 排名  提交者  添加  删除  总改动  提交  │
│ 🥇   张三    ...                       │
└─────────────────────────────────────────┘
```

## 🚀 实战示例

### 示例 1：对比主分支和开发分支

**第一次分析：master 分支**
1. 选择 "master"
2. 点击"开始分析"
3. 记录结果

**第二次分析：develop 分支**
1. 选择 "develop"
2. 点击"开始分析"
3. 对比两次结果

### 示例 2：统计功能分支

假设你要统计 `feature/user-auth` 分支：
1. 在自定义分支输入框输入 `feature/user-auth`
2. 按 Enter
3. 点击"开始分析"

### 示例 3：版本发布前的代码审查

统计 `release/v2.0` 分支：
1. 输入 `release/v2.0`
2. 查看代码量和提交次数
3. 评估是否准备好发布

## 📊 统计差异说明

### 为什么不同分支的统计结果不同？

1. **提交历史不同**
   - 某些提交可能只在特定分支
   - 分支之间可能还没有合并

2. **作者贡献不同**
   - 某个作者可能只在特定分支工作
   - 不同分支的开发人员可能不同

3. **代码量差异**
   - develop 分支通常比 master 分支有更多未发布的代码
   - feature 分支只包含该功能的代码

## 🔍 高级用法

### 统计多个仓库的同一分支

1. 选择包含多个仓库的文件夹
2. 选择统计分支（如 "master"）
3. 系统会对所有仓库统计同一分支
4. 在总体统计中汇总结果

### 排除特定分支

如果想排除某些分支的提交：
1. 统计"所有分支"获得总量
2. 统计要排除的分支
3. 用总量减去要排除的分支量

---

**更新日期**：2025-11-03  
**版本**：v1.2.0

## 💬 反馈建议

如果你有关于分支统计功能的建议，欢迎反馈：
- 是否需要支持分支对比视图？
- 是否需要支持多分支同时统计？
- 是否需要分支统计图表？

